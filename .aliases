brew-clean() {
    setopt localoptions rmstarsilent
    brew bundle cleanup --force --file=${XDG_CONFIG_HOME}/homebrew/Brewfile \
    &&\
    brew cleanup --prune=all --scrub \
    && \
    du -sh $(brew --cache)/* \
    &&
    rm -vrf $(brew --cache)/*
}

brew-i() {
    brew install $@
    brew bundle add $@
}

brew-sync() {
    brew bundle --file=${XDG_CONFIG_HOME}/homebrew/Brewfile
    brew bundle dump --force --all --file=${XDG_CONFIG_HOME}/homebrew/Brewfile
}

macos-u() {
    touch /tmp/.com.apple.dt.CommandLineTools.installondemand.in-progress
    sudo softwareupdate \
        --install \
        --all \
        --agree-to-license \
        --force \
        --restart
    rm /tmp/.com.apple.dt.CommandLineTools.installondemand.in-progress
}

macos-clt() {
    touch /tmp/.com.apple.dt.CommandLineTools.installondemand.in-progress
    local clt_label=$(softwareupdate --list 2>/dev/null | grep "Command Line Tools" | grep "Label:" | awk -F'Label: ' '{print $2}' | head -n 1)
    if [[ -n "$clt_label" ]]; then
        echo "Installing $clt_label..."
        sudo softwareupdate --install --agree-to-license --verbose --force "$clt_label"
    fi
    rm /tmp/.com.apple.dt.CommandLineTools.installondemand.in-progress
}
