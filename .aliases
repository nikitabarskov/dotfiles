brew-clean() {
    setopt localoptions rmstarsilent
    brew autoremove && \
    brew bundle cleanup --verbose --force --global \
    &&\
    brew cleanup --verbose --prune=all --scrub \
    && \
    du -sh $(brew --cache)/* \
    &&
    rm -vrf $(brew --cache)/*
}

brew-add() {
    brew install $@
    brew bundle --verbose --global  add $@
}

brew-install() {
    brew bundle install --global --verbose
}

brew-lock() {
    brew bundle dump --force --all --verbose --global
}

brew-upgrade() {
    brew update && \
    brew bundle install --global --upgrade --verbose &&
    brew-clean
}

macos-u() {
    touch /tmp/.com.apple.dt.CommandLineTools.installondemand.in-progress
    sudo softwareupdate \
        --install \
        --all \
        --agree-to-license \
        --force \
        --restart
    rm /tmp/.com.apple.dt.CommandLineTools.installondemand.in-progress
}

macos-clt() {
    touch /tmp/.com.apple.dt.CommandLineTools.installondemand.in-progress
    local clt_label=$(softwareupdate --list 2>/dev/null | grep "Command Line Tools" | grep "Label:" | awk -F'Label: ' '{print $2}' | head -n 1)
    if [[ -n "$clt_label" ]]; then
        echo "Installing $clt_label..."
        sudo softwareupdate --install --agree-to-license --verbose --force "$clt_label"
    fi
    rm /tmp/.com.apple.dt.CommandLineTools.installondemand.in-progress
}

nb() {
    local date=$(date +%Y%m%dT%H%M%S)
    echo "nikita.barskov-$date-$1"
}
